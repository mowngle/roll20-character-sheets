<input class="character_type" name="attr_character_type" type="hidden" value="character">
<input class="settings_toggle" name="attr_settings_toggle" type="hidden" value="off"/>

<div class="topback character">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>STARFLEET PERSONNEL FILE</h1>
        </div>
        <div class='charinfo'>
            <div class="charinfocontainer">
                <span class="label">NAME:</span><input type="text" name="attr_character_name"/>
            </div>
            <div class="sheet-2colrow">
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">SPECIES:</span><input type="text" name="attr_species"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">ENVIRONMENT:</span><input type="text" name="attr_environment"/>
                    </div>
                </div>
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">RANK:</span><input type="text" name="attr_rank"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">UPBRINGING:</span><input type="text" name="attr_upbringing"/>
                    </div>
                </div>
            </div>
            <div class="charinfocontainer">
                <span class="label">ASSIGNMENT:</span><input type="text" name="attr_assignment"/>
            </div>
            <div class="charinfocontainer">
                <span class="label">TRAITS:</span><input type="text" name="attr_traits"/>
            </div>
        </div>
    </div>
</div>
<div class="topback starship">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>STARSHIP REGISTRY ENTRY</h1>
        </div>
        <div class='charinfo'>
            <div class="sheet-2colrow">
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">NAME:</span><input type="text" name="attr_character_name"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">SERVICE DATE:</span><input type="text" name="attr_service_date"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">MISSION PROFILE:</span><input type="text" name="attr_mission_profile"/>
                    </div>
                </div>
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">DESIGNATION:</span><input type="text" name="attr_designation"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">SPACE FRAME:</span><input type="text" name="attr_space_frame"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">REFIT:</span><input type="text" name="attr_refit"/>
                    </div>
                </div>
            </div>
            <div class="charinfocontainer">
                <span class="label">TRAITS:</span><input type="text" name="attr_starship_traits"/>
            </div>
        </div>
    </div>
</div>
<div class="topback settings">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>SHEET SETTINGS</h1>
        </div>
        <div class="sheet-row" style="width: 100%;">
            <div class="sheet-col" style="margin-right: 60px; width: 45%">
                <div class="sectionheader">
                    <span class="label">SHEET TYPE</span>
                </div>
                <div class="attributecontainer">
                    <select name="attr_header_text">
                        <option value="character">STARFLEET PERSONNEL FILE</option>
                        <option value="starship">STARSHIP REGISTRY ENTRY</option>
                    </select>
                </div>
                <div class="sectionheader">
                    <span class="label">SHEET VERSION</span>
                </div>
                <div class="attributecontainer">
                    <input type="hidden" name="attr_version"/>
                    <span class="label" title="SHEET VERSION">VERSION</span><input type="number" name="attr_disp_version" disabled="true" value="@{version}"/>
                </div>
            </div>
            <div class="sheet-col">
                <div class="sectionheader">
                    <span class="label">STRESS</span>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">CURRENT</span><input type="number" min=0 name="attr_stress" value="0">
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">BONUS</span><input type="number" name="attr_stress_bonus" value="0">
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">MAX</span><input type="number" min=0 name="attr_stress_max" disabled="true" title="Default Value: Fitness + Security + Stress Bonus" value="(@{fitness} + @{security} + @{stress_bonus})"/>
                        </div>
                    </div>
                </div>
                <div class="sectionheader">
                    <span class="label">SHIELDS</span>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">CURRENT</span><input type="number" min=0 name="attr_shields" value="0">
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">BONUS</span><input type="number" name="attr_shields_bonus" value="0">
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">MAX</span><input type="number" min=0 name="attr_shields_max" disabled="true" title="Default Value: Ship Structure + Ship Security + Shield Bonus" value="(@{ship_structure} + @{ship_security} + @{shields_bonus})"/>
                        </div>
                    </div>
                </div>
                <div class="sectionheader">
                    <span class="label">POWER</span>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col">
                        <div class="attributecontainer">
                            <span class="label">BONUS</span><input type="number" name="attr_power_bonus" value="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="vertdeco"></div>
<div class="sidedeco1"></div>
<div class="sidedeco2"></div>
<div class="bottomback settings">
    <div class="bottomsection">
        <div class="instructions" style="padding-right: 10px;">
            <div class="sectionheader">
                <span class="label">NOTE</span>
            </div>
            Your GM should create a rollable table called "Challenge-Dice" with name values of "1", "2", "0", "0", "1 plus Effect", and "1 plus Effect".
            Dice graphics for these entries can be found at:
            <span style="font-style: italics; font-weight: bold">
                https://github.com/Roll20/roll20-character-sheets/tree/master/Star Trek Adventures 2d20
            </span>.
        </div>
        <div class="additional-notes" style="padding-right: 10px;">
            <div class="sectionheader">
                <span class="label">ADDITIONAL NOTES</span>
            </div>
            <textarea name="attr_More_add_Notes"></textarea>
        </div>
        <div class="legal">
            &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
        </div>
    </div>
</div>
<div class="bottomback character">
    <div class="bottomsection">
        <div class="sheet-row">
            <div class="sheet-col" style="margin: 0px;">
                <div class='attributes'>
                    <div class="sectionheader">
                        <span class="label">ATTRIBUTES</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_control' value="&amp;{template:lcars}{{roll_name=Control Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Control}}{{attr_num=@{control}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{control}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{control}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                   <span>CONTROL</span>
                                </button>
                                <input name="attr_control" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_fitness' value="&amp;{template:lcars}{{roll_name=Fitness Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Fitness}}{{attr_num=@{fitness}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{fitness}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{fitness}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>FITNESS</span>
                                </button>
                                <input name="attr_fitness" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_presence' value="&amp;{template:lcars}{{roll_name=Presence Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Presence}}{{attr_num=@{presence}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{presence}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{presence}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>PRESENCE</span>
                                </button>
                                <input name="attr_presence" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_daring' value="&amp;{template:lcars}{{roll_name=Daring Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Daring}}{{attr_num=@{daring}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{daring}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{daring}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>DARING</span>
                                </button>
                                <input name="attr_daring" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_insight' value="&amp;{template:lcars}{{roll_name=Insight Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Insight}}{{attr_num=@{insight}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{insight}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{insight}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>INSIGHT</span>
                                </button>
                                <input name="attr_insight" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_reason' value="&amp;{template:lcars}{{roll_name=Reason Task}}{{diff_num=?{Task Difficulty:|0}}}{{attr=Reason}}{{attr_num=@{reason}}}?{Select a Disciplne|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{reason}]]&amp;#125;&amp;#125;|Command,{{discp=Command&amp;#125;&amp;#125;{{discp_num=@{command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Security&amp;#125;&amp;#125;{{discp_num=@{security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Science&amp;#125;&amp;#125;{{discp_num=@{science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Conn&amp;#125;&amp;#125;{{discp_num=@{conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Engineering&amp;#125;&amp;#125;{{discp_num=@{engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Medicine&amp;#125;&amp;#125;{{discp_num=@{medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{reason}+@{medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>REASON</span>
                                </button>
                                <input name="attr_reason" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='disciplines'>
                    <div class="sectionheader">
                        <span class="label">DISCIPLINES</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_command' value="&amp;{template:lcars}{{roll_name=Command Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Command}}{{discp_num=@{command}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{command}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{command}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{command}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>COMMAND</span>
                                </button>
                                <input name="attr_command" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_security' value="&amp;{template:lcars}{{roll_name=Security Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Security}}{{discp_num=@{security}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{security}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{security}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{security}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>SECURITY</span>
                                </button>
                                <input name="attr_security" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_science' value="&amp;{template:lcars}{{roll_name=Science Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Science}}{{discp_num=@{science}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{science}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{science}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{science}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>SCIENCE</span>
                                </button>
                                <input name="attr_science" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_conn' value="&amp;{template:lcars}{{roll_name=Conn Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Conn}}{{discp_num=@{conn}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{conn}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{conn}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{conn}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>CONN</span>
                                </button>
                                <input name="attr_conn" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_engineering' value="&amp;{template:lcars}{{roll_name=Engineering Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Engineering}}{{discp_num=@{engineering}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{engineering}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{engineering}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{engineering}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>ENGINEERING</span>
                                </button>
                                <input name="attr_engineering" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_medicine' value="&amp;{template:lcars}{{roll_name=Medicine Task}}{{diff_num=?{Task Difficulty:|0}}}{{discp=Medicine}}{{discp_num=@{medicine}}}?{Select an Attribute|None,{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs1<@{medicine}]]&amp;#125;&amp;#125;|Control,{{attr=Control&amp;#125;&amp;#125;{{attr_num=@{control}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{control}]]]]&amp;#125;&amp;#125;|Fitness,{{attr=Fitness&amp;#125;&amp;#125;{{attr_num=@{fitness}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{fitness}]]]]&amp;#125;&amp;#125;|Presence,{{attr=Presence&amp;#125;&amp;#125;{{attr_num=@{presence}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{presence}]]]]&amp;#125;&amp;#125;|Daring,{{attr=Daring&amp;#125;&amp;#125;{{attr_num=@{daring}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{daring}]]]]&amp;#125;&amp;#125;|Insight,{{attr=Insight&amp;#125;&amp;#125;{{attr_num=@{insight}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{insight}]]]]&amp;#125;&amp;#125;|Reason,{{attr=Reason&amp;#125;&amp;#125;{{attr_num=@{reason}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;2&amp;#125;d20cf20cs<[[?{Applicable Focus&amp;#124;yes&amp;#44;@{medicine}&amp;#124;no&amp;#44;0&amp;#125;]]<[[@{medicine}+@{reason}]]]]&amp;#125;&amp;#125;}">
                                    <span>MEDICINE</span>
                                </button>
                                <input name="attr_medicine" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='values'>
                    <div class="sectionheader">
                        <span class="label">VALUES</span>
                    </div>
                    <textarea name="attr_values"></textarea>
                </div>
                <div class="determination" style="margin-top: 5px;">
                    <span class="label">DETERMINATION</span>
                    <span class=determination-values>
                        <input type="checkbox" name="attr_det1"/><span></span>
                        <input type="checkbox" name="attr_det2"/><span></span>
                        <input type="checkbox" name="attr_det3"/><span></span>
                    </span>
                </div>
                <div class="momentum" style="margin-top: 8px;">
                    <span class="label">MOMENTUM</span>
                    <span class=momentum-values>
                        <input type="checkbox" name="attr_momentum1"/><span></span>
                        <input type="checkbox" name="attr_momentum2"/><span></span>
                        <input type="checkbox" name="attr_momentum3"/><span></span>
                        <input type="checkbox" name="attr_momentum4"/><span></span>
                        <input type="checkbox" name="attr_momentum5"/><span></span>
                        <input type="checkbox" name="attr_momentum6"/><span></span>
                    </span>
                </div>
                <div class='talents'>
                    <div class="sectionheader">
                        <span class="label">TALENTS</span>
                    </div>
                    <textarea name="attr_talents"></textarea>
                </div>
                <div class='weapons'>
                    <div class="sectionheader">
                        <span class="label">WEAPONS</span>
                    </div>
                    <fieldset class="repeating_weapons">
                        <div class="sheet-row">
                            <div class="weaponscontainer">
                                <span class="label">NAME/TYPE</span><input name="attr_weapname" type="text" style="width: 248px"/>
                            </div>
                            <div class="weaponscontainer">
                                <button type="roll" name="roll_weapon" value="/roll @{weapval}t[Challenge-Dice]">
                                    <image src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Star Trek Adventures 2d20/logosmall.png"/>
                                </button>
                                <input name="attr_weapval" type="number" min=1 max=15 title="All Personal Weapons: Weapon's Damage Rating (p.193) + Security Disciplne" value="1"/>
                            </div>
                        </div>
                        <div class="weaponscontainer" style="margin-top: 4px; width: 100%">
                            <span class="label">QUALITIES</span><input name="attr_weaponqualities" type="text"/>
                        </div>
                        <hr/>
                    </fieldset>
                </div>
            </div>
            <div class="sheet-col" style="margin-left: 30px; width: 350px;">
                <div class='focuses'>
                    <div class="sectionheader">
                        <span class="label">FOCUSES</span>
                    </div>
                    <textarea name="attr_focuses"></textarea>
                </div>
                <div class='stress'>
                    <div class="sectionheader">
                        <span class="label">STRESS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_1_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_1"/><span></span>
                            <input type="hidden" name="attr_stress_2_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_2"/><span></span>
                            <input type="hidden" name="attr_stress_3_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_3"/><span></span>
                            <input type="hidden" name="attr_stress_4_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_4"/><span></span>
                            <input type="hidden" name="attr_stress_5_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_5"/><span></span>
                            <input type="hidden" name="attr_stress_6_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_6"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_7_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_7"/><span></span>
                            <input type="hidden" name="attr_stress_8_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_8"/><span></span>
                            <input type="hidden" name="attr_stress_9_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_9"/><span></span>
                            <input type="hidden" name="attr_stress_10_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_10"/><span></span>
                            <input type="hidden" name="attr_stress_11_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_11"/><span></span>
                            <input type="hidden" name="attr_stress_12_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_12"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_13_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_13"/><span></span>
                            <input type="hidden" name="attr_stress_14_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_14"/><span></span>
                            <input type="hidden" name="attr_stress_15_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_15"/><span></span>
                            <input type="hidden" name="attr_stress_16_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_16"/><span></span>
                            <input type="hidden" name="attr_stress_17_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_17"/><span></span>
                            <input type="hidden" name="attr_stress_18_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_18"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_19_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_19"/><span></span>
                            <input type="hidden" name="attr_stress_20_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_20"/><span></span>
                            <input type="hidden" name="attr_stress_21_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_21"/><span></span>
                            <input type="hidden" name="attr_stress_22_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_22"/><span></span>
                            <input type="hidden" name="attr_stress_23_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_23"/><span></span>
                            <input type="hidden" name="attr_stress_24_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_24"/><span></span>
                        </div>
                    </div>
                </div>
                <div class='injuries'>
                    <div class="sectionheader">
                        <span class="label">INJURIES</span>
                    </div>
                    <textarea name="attr_injuries"></textarea>
                </div>
                <div class='other_equipment'>
                    <div class="sectionheader">
                        <span class="label">OTHER EQUIPMENT</span>
                    </div>
                    <textarea name="attr_other-equip"></textarea>
                </div>
            </div>
            <div class="legal">
                &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
            </div>
        </div>
    </div>
</div>
<div class="bottomback starship">
    <div class="bottomsection">
        <div class="sheet-row">
            <div class="sheet-col" style="margin-right: 25px;">
                <div class='attributes'>
                    <div class="sectionheader">
                        <span class="label">SYSTEMS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_engines' value="&amp;{template:lcars}{{roll_name=Engines Check}}{{attr=Ship Engines}}{{attr_num=@{ship_engines}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_engines}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_engines}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_engines}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_engines}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_engines}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engines}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_engines}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}">
                                   <span>ENGINES</span>
                                </button>
                                <input name="attr_ship_engines" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_engine_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_computers' value="&amp;{template:lcars}{{roll_name=Computers Check}}{{attr=Ship Computers}}{{attr_num=@{ship_computers}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_computers}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_computers}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_computers}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_computers}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_computers}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_computers}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_computers}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>COMPUTERS</span>
                                </button>
                                <input name="attr_ship_computers" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_computer_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_weapons' value="&amp;{template:lcars}{{roll_name=Weapons Check}}{{attr=Ship Weapons}}{{attr_num=@{ship_weapons}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_weapons}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_weapons}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_weapons}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_weapons}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_weapons}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_weapons}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_weapons}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}'">
                                    <span>WEAPONS</span>
                                </button>
                                <input name="attr_ship_weapons" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_weapons_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_structure' value="&amp;{template:lcars}{{roll_name=Structure Check}}{{attr=Ship Structure}}{{attr_num=@{ship_structure}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_structure}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_structure}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_structure}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_structure}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_structure}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_structure}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_structure}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}">
                                   <span>STRUCTURE</span>
                                </button>
                                <input name="attr_ship_structure" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_structure_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_sensors' value="&amp;{template:lcars}{{roll_name=Sensors Check}}{{attr=Ship Sensors}}{{attr_num=@{ship_sensors}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_sensors}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_sensors}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_sensors}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_sensors}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_sensors}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_sensors}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_sensors}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>SENSORS</span>
                                </button>
                                <input name="attr_ship_sensors" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_sensors_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_communications' value="&amp;{template:lcars}{{roll_name=Comms Check}}{{attr=Ship Comms}}{{attr_num=@{ship_comms}}}?{Select a Department|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs1<@{ship_comms}]]&amp;#125;&amp;#125;|Command,{{discp=Ship Command&amp;#125;&amp;#125;{{discp_num=@{ship_command}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_comms}+@{ship_command}]]]]&amp;#125;&amp;#125;|Security,{{discp=Ship Security&amp;#125;&amp;#125;{{discp_num=@{ship_security}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_comms}+@{ship_security}]]]]&amp;#125;&amp;#125;|Science,{{discp=Ship Science&amp;#125;&amp;#125;{{discp_num=@{ship_science}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_comms}+@{ship_science}]]]]&amp;#125;&amp;#125;|Conn,{{discp=Ship Conn&amp;#125;&amp;#125;{{discp_num=@{ship_conn}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_comms}+@{ship_conn}]]]]&amp;#125;&amp;#125;|Engineering,{{discp=Ship Engineering&amp;#125;&amp;#125;{{discp_num=@{ship_engineering}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_comms}+@{ship_engineering}]]]]&amp;#125;&amp;#125;|Medicine,{{discp=Ship Medicine&amp;#125;&amp;#125;{{discp_num=@{ship_medicine}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_comms}+@{ship_medicine}]]]]&amp;#125;&amp;#125;}">
                                    <span>COMMS</span>
                                </button>
                                <input name="attr_ship_comms" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_communications_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="scale">
                    <div class="attributecontainer">
                        <span class="label">SCALE</span><input type="number" name="attr_ship_scale" min=1 max=20 value="1"/>
                    </div>
                </div>
                <div class='departments'>
                    <div class="sectionheader">
                        <span class="label">DEPARTMENTS</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_command' value="&amp;{template:lcars}{{roll_name=Command Check}}{{discp=Ship Command}}{{discp_num=@{ship_command}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<@{ship_command}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_command}<[[@{ship_command}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>COMMAND</span>
                                </button>
                                <input name="attr_ship_command" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_security' value="&amp;{template:lcars}{{roll_name=Security Check}}{{discp=Ship Security}}{{discp_num=@{ship_security}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<@{ship_security}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_security}<[[@{ship_security}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>SECURITY</span>
                                </button>
                                <input name="attr_ship_security" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_science' value="&amp;{template:lcars}{{roll_name=Science Check}}{{discp=Ship Science}}{{discp_num=@{ship_science}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<@{ship_science}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_science}<[[@{ship_science}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>SCIENCE</span>
                                </button>
                                <input name="attr_ship_science" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_conn' value="&amp;{template:lcars}{{roll_name=Conn Check}}{{discp=Ship Conn}}{{discp_num=@{ship_conn}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<@{ship_conn}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_conn}<[[@{ship_conn}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>CONN</span>
                                </button>
                                <input name="attr_ship_conn" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_engineering' value="&amp;{template:lcars}{{roll_name=Engineering Check}}{{discp=Ship Engineering}}{{discp_num=@{ship_engineering}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<@{ship_engineering}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_engineering}<[[@{ship_engineering}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>ENGINEERING</span>
                                </button>
                                <input name="attr_ship_engineering" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_medicine' value="&amp;{template:lcars}{{roll_name=Medicine Check}}{{discp=Ship Medicine}}{{discp_num=@{ship_medicine}}}?{Select a System|None,{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<@{ship_medicine}]]&amp;#125;&amp;#125;|Engines,{{attr=Ship Engines&amp;#125;&amp;#125;{{attr_num=@{ship_engines}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_engines}]]]]&amp;#125;&amp;#125;|Computers,{{attr=Ship Computers&amp;#125;&amp;#125;{{attr_num=@{ship_computers}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_computers}]]]]&amp;#125;&amp;#125;|Weapons,{{attr=Ship Weapons&amp;#125;&amp;#125;{{attr_num=@{ship_weapons}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_weapons}]]]]&amp;#125;&amp;#125;|Structure,{{attr=Ship Structure&amp;#125;&amp;#125;{{attr_num=@{ship_structure}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_structure}]]]]&amp;#125;&amp;#125;|Sensors,{{attr=Ship Sensors&amp;#125;&amp;#125;{{attr_num=@{ship_sensors}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_sensors}]]]]&amp;#125;&amp;#125;|Comms,{{attr=Ship Comms&amp;#125;&amp;#125;{{attr_num=@{ship_comms}&amp;#125;&amp;#125;{{result=[[?{Number of d20&amp;#124;1&amp;#125;d20cf20cs<@{ship_medicine}<[[@{ship_medicine}+@{ship_comms}]]]]&amp;#125;&amp;#125;}">
                                    <span>MEDICINE</span>
                                </button>
                                <input name="attr_ship_medicine" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='talents'>
                    <div class="sectionheader">
                        <span class="label">TALENTS</span>
                    </div>
                    <textarea name="attr_ship_talents"></textarea>
                </div>
            </div>
            <div class="sheet-col">
                <div class="sheet-row">
                    <div class="sheet-col" style="margin-right: 20px;">
                        <div class='power'>
                            <div class="sectionheader">
                                <span class="label">POWER</span>
                            </div>
                            <div class="sheet-row" style="margin-top: 10px">
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">CURRENT</span><input name="attr_power" type="number" min=0 value="0"/>
                                    </div>
                                </div>
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">TOTAL</span><input name="attr_power_max" type="number" disabled="true" title="Default Value: Ship Engines + Power Bonus" value="@{ship_engines} + @{power_bonus}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class='shields'>
                            <div class="sectionheader">
                                <span class="label">SHIELDS</span>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_1_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_1" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_2_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_2" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_3_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_3" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_4_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_4" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_5_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_5" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_6_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_6" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_7_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_7" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_8_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_8" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_9_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_9" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_10_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_10" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_11_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_11" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_12_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_12" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_13_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_13" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_14_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_14" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_15_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_15" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_16_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_16" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_17_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_17" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_18_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_18" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_19_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_19" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_20_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_20" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_21_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_21" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_22_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_22" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_23_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_23" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_24_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_24" value="on" checked/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class='launch-bay'>
                            <div class="sectionheader">
                                <span class="label">LAUNCH BAY</span>
                            </div>
                            <textarea name="attr_launch_bay"></textarea>
                        </div>
                        <div class='crew'>
                            <div class="sectionheader">
                                <span class="label">CREW SUPPORT</span>
                            </div>
                            <div class="sheet-row" style="margin-top: 10px">
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">CURRENT</span><input name="attr_crew" type="number" min="0" value="@{attr_crew_max}"/>
                                    </div>
                                </div>
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">TOTAL</span><input name="attr_crew_max" type="number" disabled="true" title="Default Value: Ship Scale" value="@{ship_scale}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='weapons'>
                    <div class="sectionheader">
                        <span class="label">WEAPONS</span>
                    </div>
                    <fieldset class="repeating_weapons">
                        <div class="sheet-row">
                            <div class="weaponscontainer">
                                <span class="label">NAME/TYPE</span><input name="attr_weapname" type="text" style="width: 362px"/>
                            </div>
                            <div class="weaponscontainer">
                                <button type="roll" name="roll_weapon" value="/roll @{weapval}t[Challenge-Dice]">
                                    <image src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Star Trek Adventures 2d20/logosmall.png"/>
                                </button>
                                <input name="attr_weapval" type="number" min=1 max=15 title="Phaser: Ship Security + Ship Scale + Additional Factors of Weapon&#10;Torpedos: Torpedo Basic Damage + Ship Security" value="1"/>
                            </div>
                        </div>
                        <div class="weaponscontainer" style="margin-top: 4px; width: 100%">
                            <span class="label">QUALITIES</span><input name="attr_weaponqualities" type="text"/>
                        </div>
                        <hr/>
                    </fieldset>
                </div>
            </div>
        </div>
        <div class="legal">
            &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
        </div>
    </div>
</div>

<!--ROLL TEMPLATES-->

<div class="rolltemplates">
    <rolltemplate class="sheet-rolltemplate-lcars">
        <table>
            <tr><th>{{#roll_name}}{{roll_name}}{{/roll_name}}</th></tr>
            <tr><td class="diff">
                {{#diff_num}}
                    Task Difficulty: {{diff_num}}
                {{/diff_num}}
            </td></tr>
            <tr><td class="attr">
                {{#attr}}
                    {{attr}}: {{attr_num}}
                {{/attr}}
            </td></tr>
            <tr><td class="discp">
                {{#discp}}
                     {{discp}}: {{discp_num}}
                {{/discp}}
            </td></tr>
            <tr>
                <td class="result">{{result}} Successes</td>        
            </tr> 
        </table>
    </rolltemplate>
</div>

<!-- WORKERS -->
<script type="text/worker">

    on("sheet:opened", function () {
        versioning();
    });
    
    on("change:show_settings change:show_settings_max", function () {
        getAttrs(["show_settings"], function (v) {
            if (v.show_settings === "on") {
                setAttrs({"settings_toggle": "on"});
            } else {
                setAttrs({"settings_toggle": 0});
            }
        });
    });
    
    on("change:stress_max", function () {
        configure_stress();
    });
    
    on("change:shields_max", function () {
        configure_shields();
    });
    
    on("change:stress_1 change:stress_2 change:stress_3 change:stress_4 change:stress_5 change:stress_6 change:stress_7 change:stress_8 change:stress_9 change:stress_10 change:stress_11 change:stress_12 change:stress_13 change:stress_14 change:stress_15 change:stress_16 change:stress_17 change:stress_18 change:stress_19 change:stress_20 change:stress_21 change:stress_22 change:stress_23 change:stress_24", function () {
        count_stress();
    });
    
    on("change:shields_1 change:shields_2 change:shields_3 change:shields_4 change:shields_5 change:shields_6 change:shields_7 change:shields_8 change:shields_9 change:shields_10 change:shields_11 change:shields_12 change:shields_13 change:shields_14 change:shields_15 change:shields_16 change:shields_17 change:shields_18 change:shields_19 change:shields_20 change:shields_21 change:shields_22 change:shields_23 change:shields_24", function () {
        count_shields();
    });
    
    on("change:stress", function () {
        update_stress();
    });
    
    on("change:shields", function () {
        update_shields();
    });
    
    on("change:header_text", function () {
        getAttrs(["header_text"], function (v) {
            if (v.header_text && v.header_text === "starship") {
                setAttrs({
                    "character_type": "starship"
                });
            } else if (v.header_text && v.header_text === "settings") {
                setAttrs({
                    "character_type": "settings"
                });
            } else {
                setAttrs({
                    "character_type": "character"
                });
            }
        });
    });
    
    var configure_stress = function () {
    
        getAttrs(["fitness", "security", "stress_bonus"], function (v) {
            var attrs = {};
            var fit = parseInt(v.fitness) || 0;
            var sec = parseInt(v.security) || 0;
            var bon = parseInt(v.stress_bonus) || 0;
            var tot = fit + sec + bon;
    
            for (i = 1; i <= tot; i += 1) {
                attrs["stress_".concat(i, "_enabled")] = "true";
            }
    
            for (i = tot + 1; i <= 24; i += 1) {
                attrs["stress_".concat(i)] = 0;
                attrs["stress_".concat(i, "_enabled")] = "false";
            }
    
            setAttrs(attrs);
        });
    };
    
    var configure_shields = function () {
    
        getAttrs(["ship_structure", "ship_security", "shields_bonus"], function (v) {
            var attrs = {};
            var str = parseInt(v.ship_structure) || 0;
            var sec = parseInt(v.ship_security) || 0;
            var bon = parseInt(v.shields_bonus) || 0;
            var tot = str + sec + bon;
            for (i = 1; i <= tot; i+=1) {
                attrs["shields_".concat(i, "_enabled")] = "true";
            }
            for (i = tot + 1; i <= 24; i+=1) {
                attrs["shields_".concat(i)] = 0;
                attrs["shields_".concat(i, "_enabled")] = "false";
            }
            setAttrs(attrs);
        });
    };
    
    var do_checkbox_count = function (checkboxen) {
        var total = 0;
        Object.keys(checkboxen).forEach(function (key) {
            if (checkboxen[key] === "on") {
                total += 1;
            }
        });
        return total;
    };
    
    var get_attr_list = function (attr_name, attr_count) {
        var attr_list = [];
        for (i = 0; i <= attr_count; i+=1) {
            attr_list.push(attr_name.concat("_", i));
        }
        return attr_list;
    };
    
    var count_stress = function() {
        getAttrs(get_attr_list("stress", 24), function(v) {
            setAttrs({"stress": do_checkbox_count(v)});
        });
    };
    
    var count_shields = function() {
        getAttrs(get_attr_list("shields", 24), function (v) {
            setAttrs({"shields": do_checkbox_count(v)});
        });
    };
    
    var update_stress = function () {
        var attr_list = ["stress"];
        attr_list = attr_list.concat(get_attr_list("stress", 24));
        getAttrs(attr_list, function (v) {
            update_checkbox_things("stress", v);
        });
    };
    
    var update_shields = function () {
        var attr_list = ["shields"];
        attr_list = attr_list.concat(get_attr_list("shields", 24));
        getAttrs(attr_list, function (v) {
            update_checkbox_things("shields", v);
        });
    };
    
    var update_checkbox_things = function (skip_attr, v) {
        var newval = parseInt(v[skip_attr]);
        var curval = do_checkbox_count(v);
        var attrs = {};
        if (newval === 0) {
            Object.keys(v).forEach(function (key) {
                if (key !== skip_attr){
                    attrs[key] = 0;
                }
            });
            setAttrs(attrs);
            return;
        }
        var diff = (newval - curval);
        if (diff < 0) {
            // reverse the key order (yeah, yeah, this isn't great but works)
            var revkeys = [];
            Object.keys(v).forEach(function (key) {
                revkeys.unshift(key);
            });
            for (i = 0; i<revkeys.length; i+=1) {
                if (revkeys[i] !== skip_attr) {
                    if (v[revkeys[i]] === "on") {
                        attrs[revkeys[i]] = 0;
                        diff ++;
                    }
                    if (diff === 0) {
                        break;
                    }
                }
            }
        }
        if (diff > 0) {
            Object.keys(v).forEach(function(key) {
                if (diff > 0 && key !== skip_attr) {
                    if (v[key] != "on") {
                        attrs[key] = "on";
                        diff --;
                    }
                }
            });
        }
        setAttrs(attrs);
    };
    
    var versioning = function () {
        getAttrs(["version"], function (v) {
            console.log("CURRENT VERSION IS: ".concat(v.version));
            if (!v["version"] || v["version"] === "" ) {
                update_to_1_1();
            } else {
                setAttrs({"version": "1.1"});
                console.log("Star Trek Adventures 2d20 version " + v.version);
            }
        });
    };
    
    var update_to_1_1 = function () {
        console.log("UPDATING TO SHEET VERSION 1.1");
        configure_stress();
        configure_shields();
        getAttrs(["wep1_name", "wep1_dr", "wep1_qualities", "wep2_name", "wep2_dr", "wep2_qualities", "wep3_name", "wep3_dr", "wep3_qualities"], function (v){
            update_dyanamic_weapon(v.wep1_name, v.wep1_dr, v.wep1_qualities);
            update_dyanamic_weapon(v.wep2_name, v.wep2_dr, v.wep2_qualities);
            update_dyanamic_weapon(v.wep3_name, v.wep3_dr, v.wep3_qualities);
            setAttrs({"version": "1.1"});
            console.log("Star Trek Adventures 2d20 version " + v.version);
        });
    };
    
    var update_dyanamic_weapon = function (wep_name, wep_dr, wep_qual) {
        if (wep_name) {
            var newrowid= generateRowID();
            var new_attrs = {};
            new_attrs["repeating_weapons_" + newrowid + "_weapname"] = wep_name;
            new_attrs["repeating_weapons_" + newrowid + "_weapval"] = wep_dr;
            new_attrs["repeating_weapons_" + newrowid + "_weaponqualities"] = wep_qual;
            setAttrs(new_attrs);
        }
    };
    
</script>
